{"format_version":"1.2","terraform_version":"1.13.4","variables":{"environment":{"value":"production"},"rules":{"value":[{"cidr_blocks":["0.0.0.0/0"],"port":80,"protocol":"tcp"},{"cidr_blocks":["0.0.0.0/0"],"port":443,"protocol":"tcp"},{"cidr_blocks":["10.0.0.0/8"],"port":22,"protocol":"tcp"}]},"vpc_id":{"value":"vpc-test123"}},"planned_values":{"outputs":{"firewall_metadata":{"sensitive":false,"type":["object",{"environment":"string","policy":["object",{"environment":"string","rules":["tuple",[["object",{"cidr_blocks":["list","string"],"port":"number","protocol":"string","rule_id":"string"}],["object",{"cidr_blocks":["list","string"],"port":"number","protocol":"string","rule_id":"string"}],["object",{"cidr_blocks":["list","string"],"port":"number","protocol":"string","rule_id":"string"}]]],"vpc_id":"string"}],"rule_count":"number","vpc_id":"string"}],"value":{"environment":"production","policy":{"environment":"production","rules":[{"cidr_blocks":["0.0.0.0/0"],"port":80,"protocol":"tcp","rule_id":"rule-2c6517b8b2c770e8b22ba6fbc91a8da6"},{"cidr_blocks":["0.0.0.0/0"],"port":443,"protocol":"tcp","rule_id":"rule-73b0d39a024f6b7103ed3f82069a9b22"},{"cidr_blocks":["10.0.0.0/8"],"port":22,"protocol":"tcp","rule_id":"rule-e36cb7e10c50a17d61057c62ebd16137"}],"vpc_id":"vpc-test123"},"rule_count":3,"vpc_id":"vpc-test123"}},"policy_json":{"sensitive":false,"type":"string","value":"{\"environment\":\"production\",\"rules\":[{\"cidr_blocks\":[\"0.0.0.0/0\"],\"port\":80,\"protocol\":\"tcp\",\"rule_id\":\"rule-2c6517b8b2c770e8b22ba6fbc91a8da6\"},{\"cidr_blocks\":[\"0.0.0.0/0\"],\"port\":443,\"protocol\":\"tcp\",\"rule_id\":\"rule-73b0d39a024f6b7103ed3f82069a9b22\"},{\"cidr_blocks\":[\"10.0.0.0/8\"],\"port\":22,\"protocol\":\"tcp\",\"rule_id\":\"rule-e36cb7e10c50a17d61057c62ebd16137\"}],\"vpc_id\":\"vpc-test123\"}"},"rule_count":{"sensitive":false,"type":"number","value":3}},"root_module":{"resources":[{"address":"null_resource.firewall_rules[0]","mode":"managed","type":"null_resource","name":"firewall_rules","index":0,"provider_name":"registry.terraform.io/hashicorp/null","schema_version":0,"values":{"triggers":{"rule":"{\"cidr_blocks\":[\"0.0.0.0/0\"],\"port\":80,\"protocol\":\"tcp\"}"}},"sensitive_values":{"triggers":{}}},{"address":"null_resource.firewall_rules[1]","mode":"managed","type":"null_resource","name":"firewall_rules","index":1,"provider_name":"registry.terraform.io/hashicorp/null","schema_version":0,"values":{"triggers":{"rule":"{\"cidr_blocks\":[\"0.0.0.0/0\"],\"port\":443,\"protocol\":\"tcp\"}"}},"sensitive_values":{"triggers":{}}},{"address":"null_resource.firewall_rules[2]","mode":"managed","type":"null_resource","name":"firewall_rules","index":2,"provider_name":"registry.terraform.io/hashicorp/null","schema_version":0,"values":{"triggers":{"rule":"{\"cidr_blocks\":[\"10.0.0.0/8\"],\"port\":22,\"protocol\":\"tcp\"}"}},"sensitive_values":{"triggers":{}}}]}},"resource_changes":[{"address":"null_resource.firewall_rules[0]","mode":"managed","type":"null_resource","name":"firewall_rules","index":0,"provider_name":"registry.terraform.io/hashicorp/null","change":{"actions":["create"],"before":null,"after":{"triggers":{"rule":"{\"cidr_blocks\":[\"0.0.0.0/0\"],\"port\":80,\"protocol\":\"tcp\"}"}},"after_unknown":{"id":true,"triggers":{}},"before_sensitive":false,"after_sensitive":{"triggers":{}}}},{"address":"null_resource.firewall_rules[1]","mode":"managed","type":"null_resource","name":"firewall_rules","index":1,"provider_name":"registry.terraform.io/hashicorp/null","change":{"actions":["create"],"before":null,"after":{"triggers":{"rule":"{\"cidr_blocks\":[\"0.0.0.0/0\"],\"port\":443,\"protocol\":\"tcp\"}"}},"after_unknown":{"id":true,"triggers":{}},"before_sensitive":false,"after_sensitive":{"triggers":{}}}},{"address":"null_resource.firewall_rules[2]","mode":"managed","type":"null_resource","name":"firewall_rules","index":2,"provider_name":"registry.terraform.io/hashicorp/null","change":{"actions":["create"],"before":null,"after":{"triggers":{"rule":"{\"cidr_blocks\":[\"10.0.0.0/8\"],\"port\":22,\"protocol\":\"tcp\"}"}},"after_unknown":{"id":true,"triggers":{}},"before_sensitive":false,"after_sensitive":{"triggers":{}}}}],"output_changes":{"firewall_metadata":{"actions":["create"],"before":null,"after":{"environment":"production","policy":{"environment":"production","rules":[{"cidr_blocks":["0.0.0.0/0"],"port":80,"protocol":"tcp","rule_id":"rule-2c6517b8b2c770e8b22ba6fbc91a8da6"},{"cidr_blocks":["0.0.0.0/0"],"port":443,"protocol":"tcp","rule_id":"rule-73b0d39a024f6b7103ed3f82069a9b22"},{"cidr_blocks":["10.0.0.0/8"],"port":22,"protocol":"tcp","rule_id":"rule-e36cb7e10c50a17d61057c62ebd16137"}],"vpc_id":"vpc-test123"},"rule_count":3,"vpc_id":"vpc-test123"},"after_unknown":false,"before_sensitive":false,"after_sensitive":false},"policy_json":{"actions":["create"],"before":null,"after":"{\"environment\":\"production\",\"rules\":[{\"cidr_blocks\":[\"0.0.0.0/0\"],\"port\":80,\"protocol\":\"tcp\",\"rule_id\":\"rule-2c6517b8b2c770e8b22ba6fbc91a8da6\"},{\"cidr_blocks\":[\"0.0.0.0/0\"],\"port\":443,\"protocol\":\"tcp\",\"rule_id\":\"rule-73b0d39a024f6b7103ed3f82069a9b22\"},{\"cidr_blocks\":[\"10.0.0.0/8\"],\"port\":22,\"protocol\":\"tcp\",\"rule_id\":\"rule-e36cb7e10c50a17d61057c62ebd16137\"}],\"vpc_id\":\"vpc-test123\"}","after_unknown":false,"before_sensitive":false,"after_sensitive":false},"rule_count":{"actions":["create"],"before":null,"after":3,"after_unknown":false,"before_sensitive":false,"after_sensitive":false}},"prior_state":{"format_version":"1.0","terraform_version":"1.13.4","values":{"outputs":{"firewall_metadata":{"sensitive":false,"value":{"environment":"production","policy":{"environment":"production","rules":[{"cidr_blocks":["0.0.0.0/0"],"port":80,"protocol":"tcp","rule_id":"rule-2c6517b8b2c770e8b22ba6fbc91a8da6"},{"cidr_blocks":["0.0.0.0/0"],"port":443,"protocol":"tcp","rule_id":"rule-73b0d39a024f6b7103ed3f82069a9b22"},{"cidr_blocks":["10.0.0.0/8"],"port":22,"protocol":"tcp","rule_id":"rule-e36cb7e10c50a17d61057c62ebd16137"}],"vpc_id":"vpc-test123"},"rule_count":3,"vpc_id":"vpc-test123"},"type":["object",{"environment":"string","policy":["object",{"environment":"string","rules":["tuple",[["object",{"cidr_blocks":["list","string"],"port":"number","protocol":"string","rule_id":"string"}],["object",{"cidr_blocks":["list","string"],"port":"number","protocol":"string","rule_id":"string"}],["object",{"cidr_blocks":["list","string"],"port":"number","protocol":"string","rule_id":"string"}]]],"vpc_id":"string"}],"rule_count":"number","vpc_id":"string"}]},"policy_json":{"sensitive":false,"value":"{\"environment\":\"production\",\"rules\":[{\"cidr_blocks\":[\"0.0.0.0/0\"],\"port\":80,\"protocol\":\"tcp\",\"rule_id\":\"rule-2c6517b8b2c770e8b22ba6fbc91a8da6\"},{\"cidr_blocks\":[\"0.0.0.0/0\"],\"port\":443,\"protocol\":\"tcp\",\"rule_id\":\"rule-73b0d39a024f6b7103ed3f82069a9b22\"},{\"cidr_blocks\":[\"10.0.0.0/8\"],\"port\":22,\"protocol\":\"tcp\",\"rule_id\":\"rule-e36cb7e10c50a17d61057c62ebd16137\"}],\"vpc_id\":\"vpc-test123\"}","type":"string"},"rule_count":{"sensitive":false,"value":3,"type":"number"}},"root_module":{}}},"configuration":{"provider_config":{"null":{"name":"null","full_name":"registry.terraform.io/hashicorp/null"}},"root_module":{"outputs":{"firewall_metadata":{"expression":{"references":["var.vpc_id","var.rules","var.environment","local.firewall_policy"]},"description":"Firewall metadata for contract validation"},"policy_json":{"expression":{"references":["local.policy_json"]},"description":"Complete firewall policy in JSON format"},"rule_count":{"expression":{"references":["var.rules"]},"description":"Number of firewall rules"}},"resources":[{"address":"null_resource.firewall_rules","mode":"managed","type":"null_resource","name":"firewall_rules","provider_config_key":"null","expressions":{"triggers":{"references":["var.rules","count.index"]}},"schema_version":0,"count_expression":{"references":["var.rules"]}}],"variables":{"environment":{"description":"Environment name"},"rules":{"description":"List of firewall rules"},"vpc_id":{"description":"VPC ID where firewall rules apply"}}}},"checks":[{"address":{"kind":"var","name":"rules","to_display":"var.rules"},"status":"pass","instances":[{"address":{"to_display":"var.rules"},"status":"pass"}]}],"timestamp":"2025-11-18T05:39:35Z","applyable":true,"complete":true,"errored":false}
